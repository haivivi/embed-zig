# embed-zig Bazel configuration

# =============================================================================
# Build options
# =============================================================================

# Bzlmod is always enabled in Bazel 9+
# CC toolchain resolution is always enabled in Bazel 9+

# =============================================================================
# Cache configuration
# =============================================================================

# Repository cache (shared across workspaces)
common --repository_cache=~/.cache/bazel-repo

# Disk cache (shared across workspaces)
build --disk_cache=~/.cache/bazel-disk

# =============================================================================
# CC toolchain
# =============================================================================

# PATH needed for C compiler (zig cc)
build --action_env=PATH=/usr/bin:/bin:/usr/sbin:/sbin:/opt/homebrew/bin:/usr/local/bin
build --host_action_env=PATH=/usr/bin:/bin:/usr/sbin:/sbin:/opt/homebrew/bin:/usr/local/bin

# =============================================================================
# ESP-IDF environment
# =============================================================================

# IDF_PATH and ADF_PATH are required for ESP builds
# These should be set in .bazelrc.user or environment
build --action_env=IDF_PATH
build --action_env=ADF_PATH
build --action_env=HOME

# =============================================================================
# BK (Beken) environment
# =============================================================================

# ARMINO_PATH is required for BK builds (Armino SDK location)
# BK_LOADER_PATH is required for BK flash (bk_loader CLI tool)
# These should be set in .bazelrc.user or environment
build --action_env=ARMINO_PATH
build --action_env=BK_LOADER_PATH

# =============================================================================
# Test options
# =============================================================================

test --test_output=errors

# =============================================================================
# CI configuration (dummy env values for build verification)
# =============================================================================

build:ci --define WIFI_SSID=CI_TEST
build:ci --define WIFI_PASSWORD=CI_TEST
build:ci --define TEST_SERVER=0.0.0.0
build:ci --define TEST_SERVER_IP=0.0.0.0
build:ci --define TEST_SERVER_PORT=8080

# =============================================================================
# User local config
# =============================================================================

# Load user local config (if exists)
# ESP-IDF related config should be placed in .bazelrc.user
try-import %workspace%/.bazelrc.user
